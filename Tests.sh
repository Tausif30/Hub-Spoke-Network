# Single comprehensive output for documentation
echo ""; echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"; echo "   AZURE HUB-AND-SPOKE ARCHITECTURE - DEPLOYMENT SUMMARY"; echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"; echo ""; echo "ðŸ“ Region: Japan East (Tokyo)"; echo "ðŸ—ï¸  Architecture: Hub-and-Spoke with Centralized Security"; echo ""; echo "--- INFRASTRUCTURE COMPONENTS ---"; echo "âœ… Hub VNet: $(az network vnet show -g Hub-Spoke-Tokyo -n vnet-hub-secure --query addressSpace.addressPrefixes[0] -o tsv)"; echo "âœ… Prod Spoke: $(az network vnet show -g Hub-Spoke-Tokyo -n vnet-spoke-prod --query addressSpace.addressPrefixes[0] -o tsv)"; echo "âœ… NonProd Spoke: $(az network vnet show -g Hub-Spoke-Tokyo -n vnet-spoke-nonprod --query addressSpace.addressPrefixes[0] -o tsv)"; echo "âœ… Azure Firewall: $(az network firewall show -g Hub-Spoke-Tokyo -n fw-hub --query ipConfigurations[0].privateIPAddress -o tsv 2>/dev/null)"; echo "âœ… VPN Gateway: $(az network vnet-gateway show -g Hub-Spoke-Tokyo -n vpn-gw-hub --query provisioningState -o tsv 2>/dev/null)"; echo "âœ… Azure Bastion: $(az network bastion show -g Hub-Spoke-Tokyo -n bastion-hub --query provisioningState -o tsv 2>/dev/null)"; echo "âœ… SQL Database: Private Link Enabled"; echo ""; echo "--- CONNECTIVITY TEST ---"; az vm run-command invoke -g Hub-Spoke-Tokyo -n vm-prod --command-id RunShellScript --scripts "ping -c 2 10.2.1.4 2>&1 | grep 'received'" --query "value[0].message" -o tsv 2>/dev/null | grep -o "[0-9]* received" || echo "âš ï¸  Run connectivity test"; echo ""; echo "--- SECURITY POSTURE ---"; echo "ðŸ”’ Zero Trust: VMs have no public IPs"; echo "ðŸ”’ Centralized Security: All traffic via Azure Firewall"; echo "ðŸ”’ Private Database: SQL accessible only via Private Link"; echo "ðŸ”’ Secure Access: Azure Bastion for admin access"; echo ""; echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Routing Details
echo ""; echo "=== Routing Configuration Summary ==="; echo ""; echo "Firewall Private IP:"; az network firewall ip-config list -g Hub-Spoke-Tokyo -f fw-hub --query "[].{Name:name,PrivateIP:privateIpAddress}" -o table 2>/dev/null; echo ""; echo "Route Tables:"; az network route-table list -g Hub-Spoke-Tokyo --query "[].{Name:name,Routes:routes[].name}" -o table; echo ""; echo "Prod Route Details:"; az network route-table route show -g Hub-Spoke-Tokyo --route-table-name rt-prod -n Default-to-FW --query "{AddressPrefix:addressPrefix,NextHopType:nextHopType,NextHopIP:nextHopIpAddress}" -o table; echo ""; echo "NonProd Route Details:"; az network route-table route show -g Hub-Spoke-Tokyo --route-table-name rt-nonprod -n Default-to-FW --query "{AddressPrefix:addressPrefix,NextHopType:nextHopType,NextHopIP:nextHopIpAddress}" -o table; echo ""; echo "Subnet Associations:"; az network vnet subnet show -g Hub-Spoke-Tokyo --vnet-name vnet-spoke-prod -n default --query "{Subnet:'vnet-spoke-prod/default',RouteTable:routeTable.id}" -o json; az network vnet subnet show -g Hub-Spoke-Tokyo --vnet-name vnet-spoke-nonprod -n default --query "{Subnet:'vnet-spoke-nonprod/default',RouteTable:routeTable.id}" -o json

# VNet Peering Status
echo ""; echo "=== Hub Peerings ==="; az network vnet peering list -g Hub-Spoke-Tokyo --vnet-name vnet-hub-secure --query "[].{Name:name,PeeringState:peeringState,UseRemoteGateways:useRemoteGateways,AllowGatewayTransit:allowGatewayTransit}" -o table; echo ""; echo "=== Prod Spoke Peerings ==="; az network vnet peering list -g Hub-Spoke-Tokyo --vnet-name vnet-spoke-prod --query "[].{Name:name,PeeringState:peeringState,UseRemoteGateways:useRemoteGateways,AllowGatewayTransit:allowGatewayTransit}" -o table; echo ""; echo "=== NonProd Spoke Peerings ==="; az network vnet peering list -g Hub-Spoke-Tokyo --vnet-name vnet-spoke-nonprod --query "[].{Name:name,PeeringState:peeringState,UseRemoteGateways:useRemoteGateways,AllowGatewayTransit:allowGatewayTransit}" -o table 2>/dev/null
